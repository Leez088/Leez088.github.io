webpackJsonp([1],{1240:function(t,e,a){"use strict";e.a={props:{breadcrumbList:{required:!1,type:Array,default:[]}},computed:{},created:function(){}}},1241:function(t,e,a){"use strict";function r(t){a(1242)}var n=a(1240),s=a(1244),i=a(150),o=r,c=i(n.a,s.a,!1,o,"data-v-3800f5f9",null);e.a=c.exports},1242:function(t,e,a){var r=a(1243);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(242)("eb8923e2",r,!0,{})},1243:function(t,e,a){e=t.exports=a(105)(!1),e.push([t.i,".page_header[data-v-3800f5f9]{padding-bottom:16px}.page_header h4[data-v-3800f5f9]{margin:7px 0 0;line-height:28px}",""])},1244:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page_header"},[a("a-breadcrumb",t._l(t.breadcrumbList,function(e,r){return a("a-breadcrumb-item",{key:r},["link"==e.type?a("router-link",{attrs:{to:e.to}},[t._v("\n\t\t\t\t"+t._s(e.title)+"\n\t\t\t")]):t._e(),"name"==e.type?a("span",[t._v(t._s(e.title))]):t._e()],1)}),1)],1)},n=[],s={render:r,staticRenderFns:n};e.a=s},1263:function(t,e,a){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}var n=a(1241),s=a(1305),i=a(243),o=a(151),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t};e.a={components:{MyBreadcrumb:n.a,MyTreeChecked:s.a},data:function(){return{breadcrumbList:[{title:"角色管理",type:"link",to:"/authority/role"},{title:"角色创建",type:"name"}],type:"create",formItemLayout:{labelCol:{span:6},wrapperCol:{span:18}},form:{},treeData:[],initData:{name:"",status:"ENABLED",desc:"",checkedKeys:[]},submitParams:{}}},computed:c({},Object(o.mapGetters)(["userInfo"])),created:function(){this.init()},methods:{init:function(){var t=this,e=this.$route.params;if(this.form=this.$form.createForm(this,{name:"role_form"}),e.id){this.type=e.type;var a="view"==this.type?"角色查看":"角色修改";this.$set(this.breadcrumbList,"1",{title:a,type:"name"});var n={limit:10,pageNum:1,statusId:"",roleName:"",roleId:e.id};i.a.getRole(n).then(function(e){var a=e.resultObj;if(a){var n=[].concat(r(a.list))[0];t.initData={name:n.roleName,status:n.statusId,desc:n.description,checkedKeys:n.menuList}}}).catch(function(t){})}i.a.queryMenuList({lesseeId:this.userInfo.lesseeId}).then(function(e){if(e.resultObj.menuJson){var a=[];t.rec(e.resultObj.menuJson,a),t.treeData=[].concat(a)}}).catch(function(e){t.$message.error(e.errorContext&&e.errorContext.errorMsg?e.errorContext.errorMsg:"接口异常")})},rec:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0,r=!1,n=void 0;try{for(var s,i=t[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var o=s.value;if(o.MENU_ID&&o.MENU_NAME){var l=c({},o);l.title=o.MENU_NAME,l.key=o.MENU_ID,o.children&&o.children.length&&(l.children=[],this.rec(o.children,l.children)),e.push(l)}}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}},submit:function(){var t=this;this.form.validateFields(function(e,a){if(!e){var r={roleName:a.name,statusId:a.status,description:a.desc,powerList:a["tree-check"].join()},n=t,s=t.$route.params.type,o=t.$route.params.id,l=c({},r);o?"edit"==s&&(l.roleId=o,i.a.updateRole(l).then(function(){t.$success({title:"角色修改成功，请等待复核",onOk:function(){n.cancel()}})}).catch(function(e){t.$message.error(e.errorContext&&e.errorContext.errorMsg?e.errorContext.errorMsg:"接口异常")})):i.a.addRole(l).then(function(){t.$success({title:"角色新增成功，请等待复核",onOk:function(){n.cancel()}})}).catch(function(e){t.$message.error(e.errorContext&&e.errorContext.errorMsg?e.errorContext.errorMsg:"接口异常")})}})},cancel:function(){this.$router.push({path:"/authority/role"})},treeChange:function(t){},checkTree:function(t,e,a){return e.length>0?(a(),!0):(a("至少选择一个功能"),!1)}}}},1264:function(t,e,a){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}e.a={name:"myTreeChecked",props:{treeData:{type:Array,default:[],required:!0},value:{type:Array,default:[],required:!1},disabled:{type:Boolean,default:!1}},data:function(){return{searchValue:"",autoExpandParent:!0,dataList:[],checkedKeys:this.value||[],expandedKeys:[]}},watch:{value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.checkedKeys=[].concat(r(t))},treeData:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.generateList(this.treeData)}},created:function(){this.generateList(this.treeData)},mounted:function(){},methods:{onCheck:function(t,e){this.checkedKeys=[].concat(r(t)),this.$emit("change",Object.assign([],this.$data.value,this.checkedKeys))},treeSearch:function(t){var e=this,a=t.target.value,n=[].concat(r(this.dataList)),s=[];n.map(function(t){t.title.indexOf(a)>-1&&e.getParentKeys(t.key,n,s)}),s=new Set(s),this.expandedKeys=[].concat(r(s)),this.searchValue=a,this.autoExpandParent=!0},getParentKeys:function(t,e,a){var r=this;e.forEach(function(n){n.key===t&&n.parentKey&&(a.push(n.parentKey),r.getParentKeys(n.parentKey,e,a))})},onExpand:function(t){this.expandedKeys=t,this.autoExpandParent=!1},generateList:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=0;a<t.length;a++){var r=t[a];r.scopedSlots={title:"title"},this.dataList.push({title:r.title,key:r.key,parentKey:e}),r.children&&(this.generateList(r.children,r.key),this.expandedKeys.push(r.key))}}}}},1303:function(t,e,a){var r=a(1304);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(242)("0d0ea762",r,!0,{})},1304:function(t,e,a){e=t.exports=a(105)(!1),e.push([t.i,".content .type[data-v-c6edd64c]{padding:10px}.content .edit-form .ant-form .ant-form-item .ant-btn[data-v-c6edd64c]{margin-left:10px}",""])},1305:function(t,e,a){"use strict";function r(t){a(1306)}var n=a(1264),s=a(1308),i=a(150),o=r,c=i(n.a,s.a,!1,o,"data-v-33da2014",null);e.a=c.exports},1306:function(t,e,a){var r=a(1307);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(242)("257bcb00",r,!0,{})},1307:function(t,e,a){e=t.exports=a(105)(!1),e.push([t.i,".tree-select[data-v-33da2014]{padding:3px 5px;border:1px solid #d9d9d9;border-radius:4px;height:230px;overflow:hidden}.tree-select .tree-nodes[data-v-33da2014]{height:172px;overflow:auto}.has-error .tree-select[data-v-33da2014]{border-color:#f5222d}",""])},1308:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tree-select"},[a("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"搜索"},on:{change:t.treeSearch}}),a("div",{staticClass:"tree-nodes"},[a("a-tree",{attrs:{checkable:"",treeData:t.treeData,expandedKeys:t.expandedKeys,autoExpandParent:t.autoExpandParent,disabled:t.disabled},on:{expand:t.onExpand,check:t.onCheck},scopedSlots:t._u([{key:"title",fn:function(e){var r=e.title;return[r.indexOf(t.searchValue)>-1?a("span",[t._v("\n\t\t\t\t\t"+t._s(r.substr(0,r.indexOf(t.searchValue)))+"\n\t\t\t\t\t"),a("span",{staticStyle:{color:"#f50"}},[t._v(t._s(t.searchValue))]),t._v("\n\t\t\t\t\t"+t._s(r.substr(r.indexOf(t.searchValue)+t.searchValue.length))+"\n\t\t\t\t")]):a("span",[t._v(t._s(r))])]}}]),model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}})],1)],1)},n=[],s={render:r,staticRenderFns:n};e.a=s},1309:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-view"},[a("MyBreadcrumb",{attrs:{breadcrumbList:t.breadcrumbList}}),a("div",{staticClass:"content"},[a("div",{staticClass:"edit-form"},[a("a-form",{attrs:{layout:"inline",form:t.form}},[a("a-row",[a("a-col",{attrs:{span:9}},[a("a-form-item",{attrs:{label:"角色名称","label-col":t.formItemLayout.labelCol,"wrapper-col":t.formItemLayout.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:t.initData.name,rules:[{required:!0,message:"必填项"},{max:40,message:"最大长度不超过40字符"},{pattern:/^[a-zA-Z0-9\u4e00-\u9fa5]+$/,message:"只能输入汉字、字母、数字或者它们的组合"}]}],expression:"[\n\t\t\t\t\t\t\t\t\t'name',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinitialValue: initData.name,\n\t\t\t\t\t\t\t\t\t\trules: [\n\t\t\t\t\t\t\t\t\t\t\t{ required: true, message: '必填项' },\n\t\t\t\t\t\t\t\t\t\t\t{ max: 40, message: '最大长度不超过40字符' },\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tpattern: /^[a-zA-Z0-9\\u4e00-\\u9fa5]+$/,\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: '只能输入汉字、字母、数字或者它们的组合',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"只能输入汉字、字母、数字且不超过40字符",disabled:"view"==t.type}})],1)],1),a("a-col",{attrs:{span:9}},[a("a-form-item",{attrs:{label:"状态","label-col":t.formItemLayout.labelCol,"wrapper-col":t.formItemLayout.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:t.initData.status,rules:[{required:!0,message:"必选项"}]}],expression:"[\n\t\t\t\t\t\t\t\t\t'status',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinitialValue: initData.status,\n\t\t\t\t\t\t\t\t\t\trules: [{ required: true, message: '必选项' }],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"状态",disabled:"view"==t.type}},[a("a-select-option",{attrs:{value:"ENABLED"}},[t._v("启用")]),a("a-select-option",{attrs:{value:"DISABLES"}},[t._v("关闭")])],1)],1)],1),a("a-col",{attrs:{span:9}},[a("a-form-item",{attrs:{label:"注释","label-col":t.formItemLayout.labelCol,"wrapper-col":t.formItemLayout.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["desc",{initialValue:t.initData.desc,rules:[{max:40,message:"最大长度不超过40字符"}]}],expression:"[\n\t\t\t\t\t\t\t\t\t'desc',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinitialValue: initData.desc,\n\t\t\t\t\t\t\t\t\t\trules: [{ max: 40, message: '最大长度不超过40字符' }],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]"}],attrs:{placeholder:"注释，最大长度不超过40字符",rows:4,disabled:"view"==t.type}})],1)],1),a("a-col",{attrs:{span:24}}),a("a-col",{attrs:{span:9}},[a("a-form-item",{attrs:{label:"功能关联","label-col":t.formItemLayout.labelCol,"wrapper-col":t.formItemLayout.wrapperCol}},[a("MyTreeChecked",{directives:[{name:"decorator",rawName:"v-decorator",value:["tree-check",{initialValue:t.initData.checkedKeys,rules:[{required:!0,message:"必选项"},{validator:t.checkTree}]}],expression:"[\n\t\t\t\t\t\t\t\t\t'tree-check',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinitialValue: initData.checkedKeys,\n\t\t\t\t\t\t\t\t\t\trules: [{ required: true, message: '必选项' }, { validator: checkTree }],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]"}],attrs:{treeData:t.treeData,disabled:"view"==t.type},on:{change:t.treeChange}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",["view"!=t.type?a("a-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确定")]):t._e(),a("a-button",{on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)],1)],1)])],1)},n=[],s={render:r,staticRenderFns:n};e.a=s},245:function(t,e,a){"use strict";function r(t){a(1303)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1263),s=a(1309),i=a(150),o=r,c=i(n.a,s.a,!1,o,"data-v-c6edd64c",null);e.default=c.exports}});